<!DOCTYPE html>
<html>
  <head><base target="_top"></head>
  <body>
    <form id="moveForm">
      <label for="sheet">ì‹œíŠ¸ ì„ íƒ:</label>
      <select id="sheet" name="sheetName">
        <? for (let i = 0; i < sheetNames.length; i++) {
             const nm = sheetNames[i]; ?>
          <option value="<?!= nm ?>"
            <?!= nm === defaultSheet ? 'selected' : '' ?>>
            <?!= nm ?>
          </option>
        <? } ?>
      </select>
      <br><br>
      <button type="button" onclick="submitMove()">í™•ì •</button>
      <button type="button" onclick="google.script.host.close()">ì·¨ì†Œ</button>
    </form>
    <script>
      function submitMove() {
        const f = document.getElementById('moveForm');
        google.script.run
          .withSuccessHandler(() => {
            alert('âœ… í™•ì • ì™„ë£Œ!');
            google.script.host.close();
          })
          .withFailureHandler(err => {
            alert('ğŸš¨ ì˜¤ë¥˜: ' + err.message);
          })
          .moveExpectedToTodayByName(f.sheetName.value);
      }
    </script>
  </body>
</html>
